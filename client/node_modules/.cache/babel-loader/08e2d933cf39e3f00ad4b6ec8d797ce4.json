{"ast":null,"code":"'use-strict';import{NOTIFICATION_TYPE,USER_ACCOUNT_TYPE}from'../constants';import{Notification}from'./notification';import{AppLocation}from'./checkIn';var log=console.log;export var sendAlertHandler=function sendAlertHandler(ctx,location){log('Alerting users...');var users=ctx.state.userDB;for(var key in users){var user=users[key];if(user.type===USER_ACCOUNT_TYPE&&_wasUserCheckedIn(user,location)){var notif=new Notification(NOTIFICATION_TYPE.alert,'You May Have COVID',\"A covid case has been reported at \".concat(location.name));user.notifications.push(notif);users[key]=user;}}ctx.setState({userDB:users},function(){log('Successfully alerted users ',ctx.state.userDB);});};var _wasUserCheckedIn=function _wasUserCheckedIn(user,location){var locs=user.checkInHistory;for(var loc in locs){if(loc.id===location.id){return true;}}return false;};export var deleteLocationHandler=function deleteLocationHandler(ctx,adCtx,location){log('Deleting location...');var locs=ctx.state.locationsDB;var key=location.id;delete locs[key];ctx.setState({locationsDB:locs},function(){log('Successfully deleted location',ctx.state.locationsDB);});adCtx.setState({locationViewed:undefined});};export var addLocationHandler=function addLocationHandler(ctx,addLocCtx){log('Adding new location...');if(_locationInputValidate(addLocCtx)){var locDB=ctx.state.locationsDB;var _addLocCtx$state=addLocCtx.state,locationName=_addLocCtx$state.locationName,address=_addLocCtx$state.address,imageUrl=_addLocCtx$state.imageUrl,maxOccupancy=_addLocCtx$state.maxOccupancy,description=_addLocCtx$state.description;var newLoc=new AppLocation(locationName,maxOccupancy,address,description,imageUrl);locDB[newLoc.id]=newLoc;ctx.setState({locationsDB:locDB},function(){log('Successfully added new location to DB',ctx.state.locationsDB);});addLocCtx.setState({newLocationAdded:true});}else{log('Unuccessful in adding new location to DB');}};export var editLocationHandler=function editLocationHandler(ctx,locCtx){log('Editing location...');if(_locationInputValidate(locCtx)){_editLocation(ctx,locCtx);locCtx.setState({newLocationAdded:true},function(){log('Successfully editted location',ctx.state.locationsDB);});}else{log('Unsuccessful in editing location');}};var _editLocation=function _editLocation(appCtx,locCtx){var locs=appCtx.state.locationsDB;var loc=locs[locCtx.state.locationName];loc.name=locCtx.state.locationName;loc.address=locCtx.state.address;loc.imageUrl=locCtx.state.imageUrl;loc.maxOccupancy=locCtx.state.maxOccupancy;loc.description=locCtx.state.description;locs[loc.name]=loc;appCtx.setState({locationsDB:locs});};var _locationInputValidate=function _locationInputValidate(locCtx){log('Validating reminder inputs...');var isNameValid=_isInvalid(locCtx.state.locationName);var isAddressValid=_isInvalid(locCtx.state.address);var isImageUrlValid=_isInvalid(locCtx.state.imageUrl);var isMaxOccValid=_isInvalid(locCtx.state.maxOccupancy);var isDescValid=_isInvalid(locCtx.state.description);locCtx.setState({isNameValid:isNameValid,isAddressValid:isAddressValid,isImageUrlValid:isImageUrlValid,isMaxOccValid:isMaxOccValid,isDescValid:isDescValid});return isNameValid&&isAddressValid&&isImageUrlValid&&isMaxOccValid&&isDescValid;};var _isInvalid=function _isInvalid(value){return value!==null&&value!==undefined&&value!==''&&value!=='select'&&value!=='undefined';};","map":{"version":3,"sources":["/Users/cd/Desktop/team27/src/js/actions/adminCheckIn.js"],"names":["NOTIFICATION_TYPE","USER_ACCOUNT_TYPE","Notification","AppLocation","log","console","sendAlertHandler","ctx","location","users","state","userDB","key","user","type","_wasUserCheckedIn","notif","alert","name","notifications","push","setState","locs","checkInHistory","loc","id","deleteLocationHandler","adCtx","locationsDB","locationViewed","undefined","addLocationHandler","addLocCtx","_locationInputValidate","locDB","locationName","address","imageUrl","maxOccupancy","description","newLoc","newLocationAdded","editLocationHandler","locCtx","_editLocation","appCtx","isNameValid","_isInvalid","isAddressValid","isImageUrlValid","isMaxOccValid","isDescValid","value"],"mappings":"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","sourcesContent":["'use-strict';\nimport { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from '../constants';\nimport { Notification } from './notification';\nimport { AppLocation } from './checkIn';\n\nconst log = console.log;\n\nexport const sendAlertHandler = (ctx, location) => {\n  log('Alerting users...');\n  const users = ctx.state.userDB;\n  for (let key in users) {\n    let user = users[key];\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(\n        NOTIFICATION_TYPE.alert,\n        'You May Have COVID',\n        `A covid case has been reported at ${location.name}`,\n      );\n      user.notifications.push(notif);\n      users[key] = user;\n    }\n  }\n\n  ctx.setState(\n    {\n      userDB: users,\n    },\n    () => {\n      log('Successfully alerted users ', ctx.state.userDB);\n    },\n  );\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n  for (let loc in locs) {\n    if (loc.id === location.id) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexport const deleteLocationHandler = (ctx, adCtx, location) => {\n  log('Deleting location...');\n  const locs = ctx.state.locationsDB;\n  const key = location.id;\n  delete locs[key];\n  ctx.setState(\n    {\n      locationsDB: locs,\n    },\n    () => {\n      log('Successfully deleted location', ctx.state.locationsDB);\n    },\n  );\n\n  adCtx.setState({\n    locationViewed: undefined,\n  });\n};\n\nexport const addLocationHandler = (ctx, addLocCtx) => {\n  log('Adding new location...');\n  if (_locationInputValidate(addLocCtx)) {\n    const locDB = ctx.state.locationsDB;\n    const { locationName, address, imageUrl, maxOccupancy, description } = addLocCtx.state;\n    const newLoc = new AppLocation(locationName, maxOccupancy, address, description, imageUrl);\n    locDB[newLoc.id] = newLoc;\n    ctx.setState(\n      {\n        locationsDB: locDB,\n      },\n      () => {\n        log('Successfully added new location to DB', ctx.state.locationsDB);\n      },\n    );\n    addLocCtx.setState({\n      newLocationAdded: true,\n    });\n  } else {\n    log('Unuccessful in adding new location to DB');\n  }\n};\n\nexport const editLocationHandler = (ctx, locCtx) => {\n  log('Editing location...');\n  if (_locationInputValidate(locCtx)) {\n    _editLocation(ctx, locCtx);\n    locCtx.setState(\n      {\n        newLocationAdded: true,\n      },\n      () => {\n        log('Successfully editted location', ctx.state.locationsDB);\n      },\n    );\n  } else {\n    log('Unsuccessful in editing location');\n  }\n};\n\nconst _editLocation = (appCtx, locCtx) => {\n  const locs = appCtx.state.locationsDB;\n  const loc = locs[locCtx.state.locationName];\n  loc.name = locCtx.state.locationName;\n  loc.address = locCtx.state.address;\n  loc.imageUrl = locCtx.state.imageUrl;\n  loc.maxOccupancy = locCtx.state.maxOccupancy;\n  loc.description = locCtx.state.description;\n  locs[loc.name] = loc;\n  appCtx.setState({\n    locationsDB: locs,\n  });\n};\n\nconst _locationInputValidate = (locCtx) => {\n  log('Validating reminder inputs...');\n  const isNameValid = _isInvalid(locCtx.state.locationName);\n  const isAddressValid = _isInvalid(locCtx.state.address);\n  const isImageUrlValid = _isInvalid(locCtx.state.imageUrl);\n  const isMaxOccValid = _isInvalid(locCtx.state.maxOccupancy);\n  const isDescValid = _isInvalid(locCtx.state.description);\n\n  locCtx.setState({\n    isNameValid: isNameValid,\n    isAddressValid: isAddressValid,\n    isImageUrlValid: isImageUrlValid,\n    isMaxOccValid: isMaxOccValid,\n    isDescValid: isDescValid,\n  });\n\n  return isNameValid && isAddressValid && isImageUrlValid && isMaxOccValid && isDescValid;\n};\n\nconst _isInvalid = (value) => {\n  return (\n    value !== null &&\n    value !== undefined &&\n    value !== '' &&\n    value !== 'select' &&\n    value !== 'undefined'\n  );\n};\n"]},"metadata":{},"sourceType":"module"}