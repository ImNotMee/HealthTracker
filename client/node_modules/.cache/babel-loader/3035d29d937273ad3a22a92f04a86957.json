{"ast":null,"code":"import { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from '../constants';\nimport { Notification } from './notification';\nimport { AppLocation } from './checkIn';\nconst log = console.log;\nexport const sendAlertHandler = (ctx, location) => {\n  log('Alerting users...');\n  const users = ctx.state.userDB;\n  console.log(\"test\", users);\n\n  for (let key in users) {\n    let user = users[key];\n    console.log(\"test\", user, user.type, _wasUserCheckedIn(user, location));\n\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(NOTIFICATION_TYPE.alert, `You Have Recently Visted ${location.name} Which Had A COVID Case`, `A covid case has been reported at ${location.name}`);\n      user.notifications.push(notif);\n      users[key] = user;\n    }\n  }\n\n  ctx.setState({\n    userDB: users\n  }, () => {\n    log('Successfully alerted users ', ctx.state.userDB);\n  });\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n\n  for (let loc in locs) {\n    console.log(\"CHECK\", loc.id, location.id, loc.id === location.id);\n\n    if (loc.id === location.id) {\n      console.log(\"was true\");\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexport const deleteLocationHandler = (ctx, adCtx, location) => {\n  log('Deleting location...');\n  const locs = ctx.state.locationsDB;\n  const key = location.id;\n  delete locs[key];\n  ctx.setState({\n    locationsDB: locs\n  }, () => {\n    log('Successfully deleted location', ctx.state.locationsDB);\n  });\n  adCtx.setState({\n    locationViewed: undefined\n  });\n};\nexport const addLocationHandler = (ctx, addLocCtx) => {\n  log('Adding new location...');\n\n  if (_locationInputValidate(addLocCtx)) {\n    const locDB = ctx.state.locationsDB;\n    const {\n      locationName,\n      address,\n      imageUrl,\n      maxOccupancy,\n      description\n    } = addLocCtx.state;\n    const newLoc = new AppLocation(locationName, maxOccupancy, address, description, imageUrl);\n    locDB[newLoc.id] = newLoc;\n    ctx.setState({\n      locationsDB: locDB\n    }, () => {\n      log('Successfully added new location to DB', ctx.state.locationsDB);\n    });\n    addLocCtx.setState({\n      newLocationAdded: true\n    });\n  } else {\n    log('Unuccessful in adding new location to DB');\n  }\n};\nexport const editLocationHandler = (ctx, locCtx) => {\n  log('Editing location...');\n\n  if (_locationInputValidate(locCtx)) {\n    _editLocation(ctx, locCtx);\n\n    locCtx.setState({\n      newLocationAdded: true\n    }, () => {\n      log('Successfully editted location', ctx.state.locationsDB);\n    });\n  } else {\n    log('Unsuccessful in editing location');\n  }\n};\n\nconst _editLocation = (appCtx, locCtx) => {\n  const locs = appCtx.state.locationsDB;\n  const loc = locs[locCtx.state.locationName];\n  loc.name = locCtx.state.locationName;\n  loc.address = locCtx.state.address;\n  loc.imageUrl = locCtx.state.imageUrl;\n  loc.maxOccupancy = locCtx.state.maxOccupancy;\n  loc.description = locCtx.state.description;\n  locs[loc.name] = loc;\n  appCtx.setState({\n    locationsDB: locs\n  });\n};\n\nconst _locationInputValidate = locCtx => {\n  log('Validating reminder inputs...');\n\n  const isNameValid = _isInvalid(locCtx.state.locationName);\n\n  const isAddressValid = _isInvalid(locCtx.state.address);\n\n  const isImageUrlValid = _isInvalid(locCtx.state.imageUrl);\n\n  const isMaxOccValid = _isInvalid(locCtx.state.maxOccupancy);\n\n  const isDescValid = _isInvalid(locCtx.state.description);\n\n  locCtx.setState({\n    isNameValid: isNameValid,\n    isAddressValid: isAddressValid,\n    isImageUrlValid: isImageUrlValid,\n    isMaxOccValid: isMaxOccValid,\n    isDescValid: isDescValid\n  });\n  return isNameValid && isAddressValid && isImageUrlValid && isMaxOccValid && isDescValid;\n};\n\nconst _isInvalid = value => {\n  return value !== null && value !== undefined && value !== '' && value !== 'select' && value !== 'undefined';\n};","map":{"version":3,"sources":["/Users/cd/Desktop/team27/src/js/actions/adminCheckIn.js"],"names":["NOTIFICATION_TYPE","USER_ACCOUNT_TYPE","Notification","AppLocation","log","console","sendAlertHandler","ctx","location","users","state","userDB","key","user","type","_wasUserCheckedIn","notif","alert","name","notifications","push","setState","locs","checkInHistory","loc","id","deleteLocationHandler","adCtx","locationsDB","locationViewed","undefined","addLocationHandler","addLocCtx","_locationInputValidate","locDB","locationName","address","imageUrl","maxOccupancy","description","newLoc","newLocationAdded","editLocationHandler","locCtx","_editLocation","appCtx","isNameValid","_isInvalid","isAddressValid","isImageUrlValid","isMaxOccValid","isDescValid","value"],"mappings":"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","sourcesContent":["import { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from '../constants';\nimport { Notification } from './notification';\nimport { AppLocation } from './checkIn';\n\nconst log = console.log;\n\nexport const sendAlertHandler = (ctx, location) => {\n  log('Alerting users...');\n  const users = ctx.state.userDB;\n  console.log(\"test\", users);\n  for (let key in users) {\n    let user = users[key];\n    console.log(\"test\", user, user.type, _wasUserCheckedIn(user, location));\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(\n        NOTIFICATION_TYPE.alert,\n        `You Have Recently Visted ${location.name} Which Had A COVID Case`,\n        `A covid case has been reported at ${location.name}`,\n      );\n      user.notifications.push(notif);\n      users[key] = user;\n    }\n  }\n\n  ctx.setState(\n    {\n      userDB: users,\n    },\n    () => {\n      log('Successfully alerted users ', ctx.state.userDB);\n    },\n  );\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n  for (let loc in locs) {\n    console.log(\"CHECK\", loc.id,location.id, loc.id === location.id )\n    if (loc.id === location.id) {\n      console.log(\"was true\")\n      return true;\n    }\n  }\n  return false;\n};\n\nexport const deleteLocationHandler = (ctx, adCtx, location) => {\n  log('Deleting location...');\n  const locs = ctx.state.locationsDB;\n  const key = location.id;\n  delete locs[key];\n  ctx.setState(\n    {\n      locationsDB: locs,\n    },\n    () => {\n      log('Successfully deleted location', ctx.state.locationsDB);\n    },\n  );\n\n  adCtx.setState({\n    locationViewed: undefined,\n  });\n};\n\nexport const addLocationHandler = (ctx, addLocCtx) => {\n  log('Adding new location...');\n  if (_locationInputValidate(addLocCtx)) {\n    const locDB = ctx.state.locationsDB;\n    const { locationName, address, imageUrl, maxOccupancy, description } = addLocCtx.state;\n    const newLoc = new AppLocation(locationName, maxOccupancy, address, description, imageUrl);\n    locDB[newLoc.id] = newLoc;\n    ctx.setState(\n      {\n        locationsDB: locDB,\n      },\n      () => {\n        log('Successfully added new location to DB', ctx.state.locationsDB);\n      },\n    );\n    addLocCtx.setState({\n      newLocationAdded: true,\n    });\n  } else {\n    log('Unuccessful in adding new location to DB');\n  }\n};\n\nexport const editLocationHandler = (ctx, locCtx) => {\n  log('Editing location...');\n  if (_locationInputValidate(locCtx)) {\n    _editLocation(ctx, locCtx);\n    locCtx.setState(\n      {\n        newLocationAdded: true,\n      },\n      () => {\n        log('Successfully editted location', ctx.state.locationsDB);\n      },\n    );\n  } else {\n    log('Unsuccessful in editing location');\n  }\n};\n\nconst _editLocation = (appCtx, locCtx) => {\n  const locs = appCtx.state.locationsDB;\n  const loc = locs[locCtx.state.locationName];\n  loc.name = locCtx.state.locationName;\n  loc.address = locCtx.state.address;\n  loc.imageUrl = locCtx.state.imageUrl;\n  loc.maxOccupancy = locCtx.state.maxOccupancy;\n  loc.description = locCtx.state.description;\n  locs[loc.name] = loc;\n  appCtx.setState({\n    locationsDB: locs,\n  });\n};\n\nconst _locationInputValidate = (locCtx) => {\n  log('Validating reminder inputs...');\n  const isNameValid = _isInvalid(locCtx.state.locationName);\n  const isAddressValid = _isInvalid(locCtx.state.address);\n  const isImageUrlValid = _isInvalid(locCtx.state.imageUrl);\n  const isMaxOccValid = _isInvalid(locCtx.state.maxOccupancy);\n  const isDescValid = _isInvalid(locCtx.state.description);\n\n  locCtx.setState({\n    isNameValid: isNameValid,\n    isAddressValid: isAddressValid,\n    isImageUrlValid: isImageUrlValid,\n    isMaxOccValid: isMaxOccValid,\n    isDescValid: isDescValid,\n  });\n\n  return isNameValid && isAddressValid && isImageUrlValid && isMaxOccValid && isDescValid;\n};\n\nconst _isInvalid = (value) => {\n  return (\n    value !== null &&\n    value !== undefined &&\n    value !== '' &&\n    value !== 'select' &&\n    value !== 'undefined'\n  );\n};\n"]},"metadata":{},"sourceType":"module"}