{"ast":null,"code":"import { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from \"../constants\";\nconst log = console.log;\nexport const sendAlertHandler = (ctx, location) => {\n  log(\"Alerting users...\");\n  const users = ctx.state.userDB;\n  log(users);\n\n  for (let key in users) {\n    let user = users[key];\n    log(user);\n\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(NOTIFICATION_TYPE.alert, \"You May Have COVID\", `A covid case has been reported at ${location.name}`);\n      user.notifications.push(notif);\n      users[key] = user;\n      log(users[key]);\n    }\n  }\n\n  ctx.setState({\n    userDB: users\n  });\n  log(\"Successfully alerted users \" + ctx.userDB);\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n\n  for (let loc in locs) {\n    log(loc.id + location.id);\n\n    if (loc.id === location.id) {\n      return true;\n    }\n  }\n\n  return false;\n};","map":{"version":3,"sources":["/Users/cd/Desktop/team27/src/js/actions/adminCheckIn.js"],"names":["NOTIFICATION_TYPE","USER_ACCOUNT_TYPE","log","console","sendAlertHandler","ctx","location","users","state","userDB","key","user","type","_wasUserCheckedIn","notif","Notification","alert","name","notifications","push","setState","locs","checkInHistory","loc","id"],"mappings":"AAAA,SAASA,iBAAT,EAA4BC,iBAA5B,QAAqD,cAArD;AAEA,MAAMC,GAAG,GAAGC,OAAO,CAACD,GAApB;AAEA,OAAO,MAAME,gBAAgB,GAAG,CAACC,GAAD,EAAMC,QAAN,KAAmB;AACjDJ,EAAAA,GAAG,CAAC,mBAAD,CAAH;AACA,QAAMK,KAAK,GAAGF,GAAG,CAACG,KAAJ,CAAUC,MAAxB;AACAP,EAAAA,GAAG,CAACK,KAAD,CAAH;;AACA,OAAK,IAAIG,GAAT,IAAgBH,KAAhB,EAAuB;AACrB,QAAII,IAAI,GAAGJ,KAAK,CAACG,GAAD,CAAhB;AACAR,IAAAA,GAAG,CAACS,IAAD,CAAH;;AACA,QAAIA,IAAI,CAACC,IAAL,KAAcX,iBAAd,IAAmCY,iBAAiB,CAACF,IAAD,EAAOL,QAAP,CAAxD,EAA0E;AACxE,UAAIQ,KAAK,GAAG,IAAIC,YAAJ,CACVf,iBAAiB,CAACgB,KADR,EAEV,oBAFU,EAGT,qCAAoCV,QAAQ,CAACW,IAAK,EAHzC,CAAZ;AAIAN,MAAAA,IAAI,CAACO,aAAL,CAAmBC,IAAnB,CAAwBL,KAAxB;AACAP,MAAAA,KAAK,CAACG,GAAD,CAAL,GAAaC,IAAb;AACAT,MAAAA,GAAG,CAACK,KAAK,CAACG,GAAD,CAAN,CAAH;AACD;AACF;;AAEDL,EAAAA,GAAG,CAACe,QAAJ,CAAa;AACXX,IAAAA,MAAM,EAAEF;AADG,GAAb;AAGAL,EAAAA,GAAG,CAAC,gCAAgCG,GAAG,CAACI,MAArC,CAAH;AACD,CAtBM;;AAwBP,MAAMI,iBAAiB,GAAG,CAACF,IAAD,EAAOL,QAAP,KAAoB;AAC5C,QAAMe,IAAI,GAAGV,IAAI,CAACW,cAAlB;;AACA,OAAK,IAAIC,GAAT,IAAgBF,IAAhB,EAAsB;AACpBnB,IAAAA,GAAG,CAACqB,GAAG,CAACC,EAAJ,GAAUlB,QAAQ,CAACkB,EAApB,CAAH;;AACA,QAAID,GAAG,CAACC,EAAJ,KAAWlB,QAAQ,CAACkB,EAAxB,EAA4B;AAC1B,aAAO,IAAP;AACD;AACF;;AACD,SAAO,KAAP;AACD,CATD","sourcesContent":["import { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from \"../constants\";\n\nconst log = console.log;\n\nexport const sendAlertHandler = (ctx, location) => {\n  log(\"Alerting users...\")\n  const users = ctx.state.userDB;\n  log(users)\n  for (let key in users) {\n    let user = users[key]\n    log(user);\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(\n        NOTIFICATION_TYPE.alert,\n        \"You May Have COVID\", \n        `A covid case has been reported at ${location.name}`);\n      user.notifications.push(notif);\n      users[key] = user\n      log(users[key]);\n    }\n  }\n\n  ctx.setState({\n    userDB: users\n  });\n  log(\"Successfully alerted users \" + ctx.userDB )\n}\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n  for (let loc in locs) {\n    log(loc.id +  location.id)\n    if (loc.id === location.id) {\n      return true;\n    }\n  }\n  return false;\n}"]},"metadata":{},"sourceType":"module"}