{"ast":null,"code":"'use-strict';import{NOTIFICATION_TYPE,USER_ACCOUNT_TYPE}from'../constants';import{Notification}from'./notification';import{AppLocation}from'./checkIn';var log=console.log;export var sendAlertHandler=function sendAlertHandler(ctx,location){log('Alerting users...');var users=ctx.state.userDB;for(var key in users){var user=users[key];if(user.type===USER_ACCOUNT_TYPE&&_wasUserCheckedIn(user,location)){var notif=new Notification(NOTIFICATION_TYPE.alert,\"You Have Recently Visted \".concat(location.name,\" Which Has Had A COVID Case\"),\"A covid case has been reported at \".concat(location.name));user.notifications.push(notif);users[key]=user;}}ctx.setState({userDB:users},function(){log('Successfully alerted users ',ctx.state.userDB);});};var _wasUserCheckedIn=function _wasUserCheckedIn(user,location){var locs=user.checkInHistory;var i;for(i=0;i<(locs===null||locs===void 0?void 0:locs.length);i++){var _locs$i;if(((_locs$i=locs[i])===null||_locs$i===void 0?void 0:_locs$i.location.id)===location.id){console.log('was true');return true;}}return false;};export var deleteLocationHandler=function deleteLocationHandler(ctx,adCtx,location){log('Deleting location...');var locs=ctx.state.locationsDB;var key=location.id;delete locs[key];ctx.setState({locationsDB:locs},function(){log('Successfully deleted location',ctx.state.locationsDB);});adCtx.setState({locationViewed:undefined});};export var addLocationHandler=function addLocationHandler(ctx,addLocCtx){log('Adding new location...');if(_locationInputValidate(addLocCtx)){var locDB=ctx.state.locationsDB;var _addLocCtx$state=addLocCtx.state,locationName=_addLocCtx$state.locationName,address=_addLocCtx$state.address,imageUrl=_addLocCtx$state.imageUrl,maxOccupancy=_addLocCtx$state.maxOccupancy,description=_addLocCtx$state.description;var newLoc=new AppLocation(locationName,maxOccupancy,address,description,imageUrl);locDB[newLoc.id]=newLoc;ctx.setState({locationsDB:locDB},function(){log('Successfully added new location to DB',ctx.state.locationsDB);});addLocCtx.setState({newLocationAdded:true});}else{log('Unuccessful in adding new location to DB');}};export var editLocationHandler=function editLocationHandler(ctx,locCtx){log('Editing location...');if(_locationInputValidate(locCtx)){_editLocation(ctx,locCtx);locCtx.setState({newLocationAdded:true},function(){log('Successfully editted location',ctx.state.locationsDB);});}else{log('Unsuccessful in editing location');}};var _editLocation=function _editLocation(appCtx,locCtx){var locs=appCtx.state.locationsDB;var loc=locs[locCtx.state.locationName];loc.name=locCtx.state.locationName;loc.address=locCtx.state.address;loc.imageUrl=locCtx.state.imageUrl;loc.maxOccupancy=locCtx.state.maxOccupancy;loc.description=locCtx.state.description;locs[loc.name]=loc;appCtx.setState({locationsDB:locs});};var _locationInputValidate=function _locationInputValidate(locCtx){log('Validating reminder inputs...');var isNameValid=_isInvalid(locCtx.state.locationName);var isAddressValid=_isInvalid(locCtx.state.address);var isImageUrlValid=_isInvalid(locCtx.state.imageUrl);var isMaxOccValid=_isInvalid(locCtx.state.maxOccupancy);var isDescValid=_isInvalid(locCtx.state.description);locCtx.setState({isNameValid:isNameValid,isAddressValid:isAddressValid,isImageUrlValid:isImageUrlValid,isMaxOccValid:isMaxOccValid,isDescValid:isDescValid});return isNameValid&&isAddressValid&&isImageUrlValid&&isMaxOccValid&&isDescValid;};var _isInvalid=function _isInvalid(value){return value!==null&&value!==undefined&&value!==''&&value!=='select'&&value!=='undefined';};","map":{"version":3,"sources":["/Users/cd/Desktop/team27/src/js/actions/adminCheckIn.js"],"names":["NOTIFICATION_TYPE","USER_ACCOUNT_TYPE","Notification","AppLocation","log","console","sendAlertHandler","ctx","location","users","state","userDB","key","user","type","_wasUserCheckedIn","notif","alert","name","notifications","push","setState","locs","checkInHistory","i","length","id","deleteLocationHandler","adCtx","locationsDB","locationViewed","undefined","addLocationHandler","addLocCtx","_locationInputValidate","locDB","locationName","address","imageUrl","maxOccupancy","description","newLoc","newLocationAdded","editLocationHandler","locCtx","_editLocation","appCtx","loc","isNameValid","_isInvalid","isAddressValid","isImageUrlValid","isMaxOccValid","isDescValid","value"],"mappings":"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","sourcesContent":["'use-strict';\nimport { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from '../constants';\nimport { Notification } from './notification';\nimport { AppLocation } from './checkIn';\n\nconst log = console.log;\n\nexport const sendAlertHandler = (ctx, location) => {\n  log('Alerting users...');\n  const users = ctx.state.userDB;\n  for (let key in users) {\n    let user = users[key];\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(\n        NOTIFICATION_TYPE.alert,\n        `You Have Recently Visted ${location.name} Which Has Had A COVID Case`,\n        `A covid case has been reported at ${location.name}`,\n      );\n      user.notifications.push(notif);\n      users[key] = user;\n    }\n  }\n\n  ctx.setState(\n    {\n      userDB: users,\n    },\n    () => {\n      log('Successfully alerted users ', ctx.state.userDB);\n    },\n  );\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n  let i;\n  for (i = 0; i < locs?.length; i++) {\n    if (locs[i]?.location.id === location.id) {\n      console.log('was true');\n      return true;\n    }\n  }\n  return false;\n};\n\nexport const deleteLocationHandler = (ctx, adCtx, location) => {\n  log('Deleting location...');\n  const locs = ctx.state.locationsDB;\n  const key = location.id;\n  delete locs[key];\n  ctx.setState(\n    {\n      locationsDB: locs,\n    },\n    () => {\n      log('Successfully deleted location', ctx.state.locationsDB);\n    },\n  );\n\n  adCtx.setState({\n    locationViewed: undefined,\n  });\n};\n\nexport const addLocationHandler = (ctx, addLocCtx) => {\n  log('Adding new location...');\n  if (_locationInputValidate(addLocCtx)) {\n    const locDB = ctx.state.locationsDB;\n    const { locationName, address, imageUrl, maxOccupancy, description } = addLocCtx.state;\n    const newLoc = new AppLocation(locationName, maxOccupancy, address, description, imageUrl);\n    locDB[newLoc.id] = newLoc;\n    ctx.setState(\n      {\n        locationsDB: locDB,\n      },\n      () => {\n        log('Successfully added new location to DB', ctx.state.locationsDB);\n      },\n    );\n    addLocCtx.setState({\n      newLocationAdded: true,\n    });\n  } else {\n    log('Unuccessful in adding new location to DB');\n  }\n};\n\nexport const editLocationHandler = (ctx, locCtx) => {\n  log('Editing location...');\n  if (_locationInputValidate(locCtx)) {\n    _editLocation(ctx, locCtx);\n    locCtx.setState(\n      {\n        newLocationAdded: true,\n      },\n      () => {\n        log('Successfully editted location', ctx.state.locationsDB);\n      },\n    );\n  } else {\n    log('Unsuccessful in editing location');\n  }\n};\n\nconst _editLocation = (appCtx, locCtx) => {\n  const locs = appCtx.state.locationsDB;\n  const loc = locs[locCtx.state.locationName];\n  loc.name = locCtx.state.locationName;\n  loc.address = locCtx.state.address;\n  loc.imageUrl = locCtx.state.imageUrl;\n  loc.maxOccupancy = locCtx.state.maxOccupancy;\n  loc.description = locCtx.state.description;\n  locs[loc.name] = loc;\n  appCtx.setState({\n    locationsDB: locs,\n  });\n};\n\nconst _locationInputValidate = (locCtx) => {\n  log('Validating reminder inputs...');\n  const isNameValid = _isInvalid(locCtx.state.locationName);\n  const isAddressValid = _isInvalid(locCtx.state.address);\n  const isImageUrlValid = _isInvalid(locCtx.state.imageUrl);\n  const isMaxOccValid = _isInvalid(locCtx.state.maxOccupancy);\n  const isDescValid = _isInvalid(locCtx.state.description);\n\n  locCtx.setState({\n    isNameValid: isNameValid,\n    isAddressValid: isAddressValid,\n    isImageUrlValid: isImageUrlValid,\n    isMaxOccValid: isMaxOccValid,\n    isDescValid: isDescValid,\n  });\n\n  return isNameValid && isAddressValid && isImageUrlValid && isMaxOccValid && isDescValid;\n};\n\nconst _isInvalid = (value) => {\n  return (\n    value !== null &&\n    value !== undefined &&\n    value !== '' &&\n    value !== 'select' &&\n    value !== 'undefined'\n  );\n};\n"]},"metadata":{},"sourceType":"module"}