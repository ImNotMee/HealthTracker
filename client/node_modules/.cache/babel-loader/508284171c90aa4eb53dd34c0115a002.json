{"ast":null,"code":"import{NOTIFICATION_TYPE,USER_ACCOUNT_TYPE}from'../constants';import{Notification}from'./notification';import{AppLocation}from'./checkIn';var log=console.log;export var sendAlertHandler=function sendAlertHandler(ctx,location){log('Alerting users...');var users=ctx.state.userDB;for(var key in users){var user=users[key];if(user.type===USER_ACCOUNT_TYPE&&_wasUserCheckedIn(user,location)){var notif=new Notification(NOTIFICATION_TYPE.alert,'You May Have COVID',\"A covid case has been reported at \".concat(location.name));user.notifications.push(notif);users[key]=user;}}ctx.setState({userDB:users},function(){log('Successfully alerted users '+JSON.stringify(ctx.state.userDB));});};var _wasUserCheckedIn=function _wasUserCheckedIn(user,location){var locs=user.checkInHistory;for(var loc in locs){if(loc.id===location.id){return true;}}return false;};export var addLocationHandler=function addLocationHandler(ctx,addLocCtx){log('Adding new location...');if(_locationInputValidate(addLocCtx)){var locDB=ctx.state.locationsDB;var _addLocCtx$state=addLocCtx.state,locationName=_addLocCtx$state.locationName,address=_addLocCtx$state.address,imageUrl=_addLocCtx$state.imageUrl,maxOccupancy=_addLocCtx$state.maxOccupancy,description=_addLocCtx$state.description;var newLoc=new AppLocation(locationName,maxOccupancy,address,description,imageUrl);locDB[newLoc.id]=newLoc;ctx.setState({locationsDB:locDB},function(){log('Successfully added new location to DB'+JSON.stringify(ctx.state.locationsDB));});addLocCtx.setState({newLocationAdded:true});}else{log('Unuccessful in adding new location to DB');}};var _locationInputValidate=function _locationInputValidate(locCtx){log('Validating reminder inputs...');var isNameValid=_isInvalid(locCtx.state.locationName);var isAddressValid=_isInvalid(locCtx.state.address);var isImageUrlValid=_isInvalid(locCtx.state.imageUrl);var isMaxOccValid=_isInvalid(locCtx.state.maxOccupancy);var isDescValid=_isInvalid(locCtx.state.description);locCtx.setState({isNameValid:isNameValid,isAddressValid:isAddressValid,isImageUrlValid:isImageUrlValid,isMaxOccValid:isMaxOccValid,isDescValid:isDescValid});return isNameValid&&isAddressValid&&isImageUrlValid&&isMaxOccValid&&isDescValid;};var _isInvalid=function _isInvalid(value){return value!==null&&value!==undefined&&value!==''&&value!=='select';};","map":{"version":3,"sources":["/Users/cd/Desktop/team27/src/js/actions/adminCheckIn.js"],"names":["NOTIFICATION_TYPE","USER_ACCOUNT_TYPE","Notification","AppLocation","log","console","sendAlertHandler","ctx","location","users","state","userDB","key","user","type","_wasUserCheckedIn","notif","alert","name","notifications","push","setState","JSON","stringify","locs","checkInHistory","loc","id","addLocationHandler","addLocCtx","_locationInputValidate","locDB","locationsDB","locationName","address","imageUrl","maxOccupancy","description","newLoc","newLocationAdded","locCtx","isNameValid","_isInvalid","isAddressValid","isImageUrlValid","isMaxOccValid","isDescValid","value","undefined"],"mappings":"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","sourcesContent":["import { NOTIFICATION_TYPE, USER_ACCOUNT_TYPE } from '../constants';\nimport { Notification } from './notification';\nimport { AppLocation } from './checkIn';\n\nconst log = console.log;\n\nexport const sendAlertHandler = (ctx, location) => {\n  log('Alerting users...');\n  const users = ctx.state.userDB;\n  for (let key in users) {\n    let user = users[key];\n    if (user.type === USER_ACCOUNT_TYPE && _wasUserCheckedIn(user, location)) {\n      let notif = new Notification(\n        NOTIFICATION_TYPE.alert,\n        'You May Have COVID',\n        `A covid case has been reported at ${location.name}`,\n      );\n      user.notifications.push(notif);\n      users[key] = user;\n    }\n  }\n\n  ctx.setState(\n    {\n      userDB: users,\n    },\n    () => {\n      log('Successfully alerted users ' + JSON.stringify(ctx.state.userDB));\n    },\n  );\n};\n\nconst _wasUserCheckedIn = (user, location) => {\n  const locs = user.checkInHistory;\n  for (let loc in locs) {\n    if (loc.id === location.id) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexport const addLocationHandler = (ctx, addLocCtx) => {\n  log('Adding new location...');\n  if (_locationInputValidate(addLocCtx)) {\n    const locDB = ctx.state.locationsDB;\n    const { locationName, address, imageUrl, maxOccupancy, description } = addLocCtx.state;\n    const newLoc = new AppLocation(locationName, maxOccupancy, address, description, imageUrl);\n    locDB[newLoc.id] = newLoc;\n    ctx.setState(\n      {\n        locationsDB: locDB,\n      },\n      () => {\n        log('Successfully added new location to DB' + JSON.stringify(ctx.state.locationsDB));\n      },\n    );\n    addLocCtx.setState({\n      newLocationAdded: true,\n    });\n  } else {\n    log('Unuccessful in adding new location to DB');\n  }\n};\n\nconst _locationInputValidate = (locCtx) => {\n  log('Validating reminder inputs...');\n  const isNameValid = _isInvalid(locCtx.state.locationName);\n  const isAddressValid = _isInvalid(locCtx.state.address);\n  const isImageUrlValid = _isInvalid(locCtx.state.imageUrl);\n  const isMaxOccValid = _isInvalid(locCtx.state.maxOccupancy);\n  const isDescValid = _isInvalid(locCtx.state.description);\n\n  locCtx.setState({\n    isNameValid: isNameValid,\n    isAddressValid: isAddressValid,\n    isImageUrlValid: isImageUrlValid,\n    isMaxOccValid: isMaxOccValid,\n    isDescValid: isDescValid,\n  });\n\n  return isNameValid && isAddressValid && isImageUrlValid && isMaxOccValid && isDescValid;\n};\n\nconst _isInvalid = (value) => {\n  return value !== null && value !== undefined && value !== '' && value !== 'select';\n};\n"]},"metadata":{},"sourceType":"module"}